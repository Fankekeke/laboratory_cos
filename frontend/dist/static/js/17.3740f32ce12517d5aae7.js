webpackJsonp([17,73,74],{H3jX:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),d=a("g4PW"),r=a.n(d),n=a("+6Bu"),o=a.n(n),l={labelCol:{span:3},wrapperCol:{span:18}},c={name:"DeptEdit",props:{deptEditVisiable:{default:!1}},data:function(){return{loading:!1,formItemLayout:l,form:this.$form.createForm(this),deptTreeKey:+new Date,dept:{},checkedKeys:[],expandedKeys:[],defaultCheckedKeys:[],deptTreeData:[]}},methods:{reset:function(){this.loading=!1,this.deptTreeKey=+new Date,this.expandedKeys=this.checkedKeys=this.defaultCheckedKeys=[],this.button={},this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleCheck:function(e){this.checkedKeys=e},handleExpand:function(e){this.expandedKeys=e},setFormValues:function(e){var t=o()(e,[]);this.form.getFieldDecorator("deptName"),this.form.setFieldsValue({deptName:t.text}),this.form.getFieldDecorator("orderNum"),this.form.setFieldsValue({orderNum:t.order}),"0"!==t.parentId&&(this.defaultCheckedKeys.push(t.parentId),this.checkedKeys=this.defaultCheckedKeys,this.expandedKeys=this.checkedKeys),this.dept.deptId=t.id},handleSubmit:function(){var e=this,t=r()(this.checkedKeys.checked,void 0)?this.checkedKeys:this.checkedKeys.checked;return t.length>1?void this.$message.error("最多只能选择一个上级部门，请修改"):t[0]===this.dept.deptId?void this.$message.error("不能选择自己作为上级部门，请修改"):void this.form.validateFields(function(a,s){if(!a){e.loading=!0;var d=e.form.getFieldsValue();d.parentId=t[0],r()(d.parentId,void 0)&&(d.parentId=0),d.deptId=e.dept.deptId,e.$put("dept",i()({},d)).then(function(){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1})}})}},watch:{deptEditVisiable:function(){var e=this;this.deptEditVisiable&&this.$get("dept").then(function(t){e.deptTreeData=t.data.rows.children,e.deptTreeKey=+new Date})}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"修改按钮",maskClosable:!1,width:"650",placement:"right",closable:!1,visible:e.deptEditVisiable},on:{close:e.onClose}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",e._b({attrs:{label:"部门名称"}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["deptName",{rules:[{required:!0,message:"部门名称不能为空"},{max:20,message:"长度不能超过20个字符"}]}],expression:"['deptName',\n                 {rules: [\n                  { required: true, message: '部门名称不能为空'},\n                  { max: 20, message: '长度不能超过20个字符'}\n                ]}]"}]})],1),e._v(" "),a("a-form-item",e._b({attrs:{label:"部门排序"}},"a-form-item",e.formItemLayout,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["orderNum"],expression:"['orderNum']"}],staticStyle:{width:"100%"}})],1),e._v(" "),a("a-form-item",e._b({staticStyle:{"margin-bottom":"2rem"},attrs:{label:"上级部门"}},"a-form-item",e.formItemLayout,!1),[a("a-tree",{key:e.deptTreeKey,attrs:{checkable:!0,checkStrictly:!0,expandedKeys:e.expandedKeys,defaultCheckedKeys:e.defaultCheckedKeys,treeData:e.deptTreeData},on:{check:e.handleCheck,expand:e.handleExpand}})],1)],1),e._v(" "),a("div",{staticClass:"drawer-bootom-button"},[a("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:e.onClose}},[a("a-button",{staticStyle:{"margin-right":".8rem"}},[e._v("取消")])],1),e._v(" "),a("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},staticRenderFns:[]},m=a("VU/8")(c,h,!1,null,null,null);t.default=m.exports},MY2p:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),d=a("g4PW"),r=a.n(d),n={labelCol:{span:3},wrapperCol:{span:18}},o={name:"DeptAdd",props:{deptAddVisiable:{default:!1}},data:function(){return{loading:!1,formItemLayout:n,form:this.$form.createForm(this),dept:{},checkedKeys:[],expandedKeys:[],deptTreeData:[],deptTreeKeys:+new Date}},methods:{reset:function(){this.loading=!1,this.deptTreeKeys=+new Date,this.expandedKeys=this.checkedKeys=[],this.dept={},this.form.resetFields()},onClose:function(){this.reset(),this.$emit("close")},handleCheck:function(e){this.checkedKeys=e},handleExpand:function(e){this.expandedKeys=e},handleSubmit:function(){var e=this,t=r()(this.checkedKeys.checked,void 0)?this.checkedKeys:this.checkedKeys.checked;t.length>1?this.$message.error("最多只能选择一个上级部门，请修改"):this.form.validateFields(function(a,s){a||(e.loading=!0,t.length?e.dept.parentId=t[0]:e.dept.parentId="",e.$post("dept",i()({},e.dept)).then(function(){e.reset(),e.$emit("success")}).catch(function(){e.loading=!1}))})}},watch:{deptAddVisiable:function(){var e=this;this.deptAddVisiable&&this.$get("dept").then(function(t){e.deptTreeData=t.data.rows.children})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{staticStyle:{height:"calc(100% - 55px)",overflow:"auto","padding-bottom":"53px"},attrs:{title:"新增部门",maskClosable:!1,width:"650",placement:"right",closable:!1,visible:e.deptAddVisiable},on:{close:e.onClose}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",e._b({attrs:{label:"部门名称"}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["deptName",{rules:[{required:!0,message:"部门名称不能为空"},{max:20,message:"长度不能超过20个字符"}]}],expression:"['deptName',\n                 {rules: [\n                  { required: true, message: '部门名称不能为空'},\n                  { max: 20, message: '长度不能超过20个字符'}\n                ]}]"}],model:{value:e.dept.deptName,callback:function(t){e.$set(e.dept,"deptName",t)},expression:"dept.deptName"}})],1),e._v(" "),a("a-form-item",e._b({attrs:{label:"部门排序"}},"a-form-item",e.formItemLayout,!1),[a("a-input-number",{staticStyle:{width:"100%"},model:{value:e.dept.orderNum,callback:function(t){e.$set(e.dept,"orderNum",t)},expression:"dept.orderNum"}})],1),e._v(" "),a("a-form-item",e._b({staticStyle:{"margin-bottom":"2rem"},attrs:{label:"上级部门"}},"a-form-item",e.formItemLayout,!1),[a("a-tree",{key:e.deptTreeKeys,attrs:{checkable:!0,checkStrictly:!0,expandedKeys:e.expandedKeys,treeData:e.deptTreeData},on:{check:e.handleCheck,expand:e.handleExpand}})],1)],1),e._v(" "),a("div",{staticClass:"drawer-bootom-button"},[a("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:e.onClose}},[a("a-button",{staticStyle:{"margin-right":".8rem"}},[e._v("取消")])],1),e._v(" "),a("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},staticRenderFns:[]},c=a("VU/8")(o,l,!1,null,null,null);t.default=c.exports},woEq:function(e,t){},xvzI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),d=a("JpjP"),r=a("MY2p"),n=a("H3jX"),o={name:"Dept",components:{DeptAdd:r.default,DeptEdit:n.default,RangeDate:d.a},data:function(){return{advanced:!1,dataSource:[],selectedRowKeys:[],queryParams:{},sortedInfo:null,pagination:{defaultPageSize:1e7,hideOnSinglePage:!0,indentSize:100},loading:!1,deptAddVisiable:!1,deptEditVisiable:!1}},computed:{columns:function(){var e=this.sortedInfo;return[{title:"名称",dataIndex:"text"},{title:"排序",dataIndex:"order"},{title:"创建时间",dataIndex:"createTime",sorter:!0,sortOrder:"createTime"===(e=e||{}).columnKey&&e.order},{title:"修改时间",dataIndex:"modifyTime",sorter:!0,sortOrder:"modifyTime"===e.columnKey&&e.order},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},fixed:"right",width:120}]}},mounted:function(){this.fetch()},methods:{onSelectChange:function(e){this.selectedRowKeys=e},handleDeptAddClose:function(){this.deptAddVisiable=!1},handleDeptAddSuccess:function(){this.deptAddVisiable=!1,this.$message.success("新增部门成功"),this.fetch()},add:function(){this.deptAddVisiable=!0},handleDeptEditClose:function(){this.deptEditVisiable=!1},handleDeptEditSuccess:function(){this.deptEditVisiable=!1,this.$message.success("修改部门成功"),this.fetch()},edit:function(e){this.deptEditVisiable=!0,this.$refs.deptEdit.setFormValues(e)},handleDateChange:function(e){e&&(this.queryParams.createTimeFrom=e[0],this.queryParams.createTimeTo=e[1])},batchDelete:function(){if(this.selectedRowKeys.length){var e=this;this.$confirm({title:"确定删除所选中的记录?",content:"当您点击确定按钮后，这些记录将会被彻底删除，如果其包含子记录，也将一并删除！",centered:!0,onOk:function(){e.$delete("dept/"+e.selectedRowKeys.join(",")).then(function(){e.$message.success("删除成功"),e.selectedRowKeys=[],e.fetch()})},onCancel:function(){e.selectedRowKeys=[]}})}else this.$message.warning("请选择需要删除的记录")},exportExcel:function(){var e=this.sortedInfo,t=void 0,a=void 0;e&&(t=e.field,a=e.order),this.$export("dept/excel",i()({sortField:t,sortOrder:a},this.queryParams))},search:function(){var e=this.sortedInfo,t=void 0,a=void 0;e&&(t=e.field,a=e.order),this.fetch(i()({sortField:t,sortOrder:a},this.queryParams))},reset:function(){this.selectedRowKeys=[],this.sortedInfo=null,this.queryParams={},this.$refs.createTime.reset(),this.fetch()},handleTableChange:function(e,t,a){this.sortedInfo=a,this.fetch(i()({sortField:a.field,sortOrder:a.order},this.queryParams,t))},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.$get("dept",i()({},t)).then(function(t){var a=t.data;e.loading=!1,e.dataSource=a.rows.children})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticClass:"card-area",attrs:{bordered:!1}},[a("div",{class:e.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:e.advanced?null:"fold"},[a("a-row",[a("a-col",{attrs:{md:12,sm:24}},[a("a-form-item",{attrs:{label:"名称",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-input",{model:{value:e.queryParams.deptName,callback:function(t){e.$set(e.queryParams,"deptName",t)},expression:"queryParams.deptName"}})],1)],1),e._v(" "),a("a-col",{attrs:{md:12,sm:24}},[a("a-form-item",{attrs:{label:"创建时间",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("range-date",{ref:"createTime",on:{change:e.handleDateChange}})],1)],1)],1)],1),e._v(" "),a("span",{staticStyle:{float:"right","margin-top":"3px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1)])],1),e._v(" "),a("div",[a("div",{staticClass:"operator"},[a("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:["dept:add"],expression:"['dept:add']"}],attrs:{type:"primary",ghost:""},on:{click:e.add}},[e._v("新增")]),e._v(" "),a("a-button",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:["dept:delete"],expression:"['dept:delete']"}],on:{click:e.batchDelete}},[e._v("删除")]),e._v(" "),a("a-dropdown",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:["dept:export"],expression:"['dept:export']"}]},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"export-data",on:{click:e.exportExcel}},[e._v("导出Excel")])],1),e._v(" "),a("a-button",[e._v("\n          更多操作 "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1),e._v(" "),a("a-table",{attrs:{columns:e.columns,dataSource:e.dataSource,pagination:e.pagination,loading:e.loading,scroll:{x:900},rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"operation",fn:function(t,s){return[a("a-icon",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:["dept:update"],expression:"['dept:update']"}],attrs:{type:"setting",theme:"twoTone",twoToneColor:"#4a9ff5",title:"修改"},on:{click:function(t){e.edit(s)}}}),e._v(" "),a("a-badge",{directives:[{name:"hasNoPermission",rawName:"v-hasNoPermission",value:["dept:update"],expression:"['dept:update']"}],attrs:{status:"warning",text:"无权限"}})]}}])})],1),e._v(" "),a("dept-add",{attrs:{deptAddVisiable:e.deptAddVisiable},on:{success:e.handleDeptAddSuccess,close:e.handleDeptAddClose}}),e._v(" "),a("dept-edit",{ref:"deptEdit",attrs:{deptEditVisiable:e.deptEditVisiable},on:{success:e.handleDeptEditSuccess,close:e.handleDeptEditClose}})],1)},staticRenderFns:[]},c=a("VU/8")(o,l,!1,function(e){a("woEq")},"data-v-479b02f3",null);t.default=c.exports}});